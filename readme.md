# Определение видов отходов в кузове транспортных средств

# Project Overview

Требуется разработать систему для распознавания отходов в кузове транспортных средств с целью снижения денежных потерь. Наша задача по имеющимся видео классифицировать отходы.

# Installation and setup

1) Установить зависимости:
```python
pip install -r requirements.txt
```
2) Для выполнения классификации одного видео:
```python
python ./models/nn_module.py --path path_to_video
```
3) Для выполнения классификации всех видео в определённой папке:
```python
python ./models/nn_module.py --dir path_to_dir
```
# Data

Для обучения были использованы предоставленные видео. Из части видео был взят первый кадр и сохранён в архив, для выполнения разметки платформ.

Сгенерированная разметка находится в архиве *dataset_yolo.zip*. Данные из этого архива были разбиты на валидационную и тренировочную выборку и сохранены в архиве *dataset.rar*.

Изображения для обучения классификатора были получены путём вырезания фрагмента со 130 по 132 секунды видео, поскольку можно гарантировать, что в этом интервале транспортное средство и его кузов будут
находиться в области видимости камеры. После этого эти фрагменты были разбиты на кадры и сохранены в соответствующие классам папки. Данные находятся в архиве *dataset_classification.rar*.

# Code structure
В директории models расположены веса моделей: ViT и Yolov8n, а также файл *nn_module.py*, испольнение которого запускает классификацию отходов в кузове транспортного средства.

В директории *notebooks* расположены блокноты, в которых выполнялось обучение выбранных сетей. Обучение производилось в Google Colab.

В директории *utils* расположены вспомогательные скрипты:
* cut_videos.py - вырезка фрагмента с 1:50 по 2:15.
* extract_images_classification.py - разбиение на кадры полученного при помощи предыдущего скрипта, видео в промежутке с 20 по 22 секунды.
* get_st_frame.py - получение первого кадра видео.
* train2val.py - разбиение разметки, сгенерированной в CVAT для yolo на train и val.

```bash
├── models
│   ├── nn_module.py
│   ├── weights
│   │   ├── checkpoint.pth
│   │   └── yolo_best.pt
├── notebooks
│   ├── ViT_train.ipynb
│   └── yolo_train.ipynb
├── utils
│   ├── cut_videos.py
│   ├── extract_images_classification.py
│   ├── get_st_frame.py
│   └── train2val.py
├── dataset.rar
├── dataset_yolo.zip
├── dataset_classification.rar
├── train_cfg.yaml
└── .gitignore
```

# Results and evaluation
В ходе экспериментов было принято решение отказаться от использования Yolo для детекции платформ, посколько ложноположительные детекции могли бы значительно ухудшить результат предсказания.
По прошествии 41 эпохи точность на валидационном множестве ViT достигла 0.81.
